name: Notify Vercel on Status Change

on:
  check_suite:
    types: [completed]
  workflow_run:
    workflows: ["*"]
    types: [completed]

permissions:
  checks: write
  statuses: write

jobs:
  notify-vercel:
    name: Notify Vercel
    runs-on: ubuntu-latest
    if: github.event.workflow_run.conclusion != 'cancelled'
    
    steps:
      - name: Notify Vercel - clothing-shop
        uses: vercel/repository-dispatch/actions/status@v1
        with:
          name: 'Vercel - clothing-shop: new-checks'
          status: ${{ github.event.workflow_run.conclusion }}
          sha: ${{ github.event.workflow_run.head_sha || github.sha }}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Log notification
        run: |
          echo "Notified Vercel of workflow status"
          echo "Status: ${{ github.event.workflow_run.conclusion }}"
          echo "SHA: ${{ github.event.workflow_run.head_sha || github.sha }}"
